<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/public/logo.ico">
    <title>Gradient Generator</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        /* Global Reset and Retro Font */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Press Start 2P', cursive;
        }

        /* Basic Retro Color Palette */
        :root {
            --window-bg: #c0c0c0; 
            --border-dark: #808080;
            --border-light: #ffffff;
            --text-color: #000000;
            --button-face: #c0c0c0;
            --button-pressed: #dfdfdf;
            --input-bg: #ffffff;
            --header-title: #000080;
            --error-color: #ffcccc;
            --success-color: #008000;
        }

        body {
            background: var(--window-bg);
            color: var(--text-color);
            line-height: 1.6;
            padding: 30px;
        }

        /* --- Classic Windows Border Mixin --- */
        .window-frame {
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            background: var(--window-bg);
            padding: 3px; 
            box-shadow: none;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0; 
        }

        /* --- Title Bar/Header --- */
        .title-bar {
            background: #008080;
            color: var(--border-light);
            padding: 5px 8px;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-dark);
        }

        .title-bar-text {
            white-space: nowrap;
        }

        /* The main window body */
        .app-body {
            padding: 15px;
        }

        /* --- Section Styling (Sunken Panel) --- */
        .section {
            margin-bottom: 15px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: var(--button-pressed);
            padding: 1px;
        }

        .section-header {
            padding: 6px 8px;
            font-size: 11px;
            font-weight: normal;
            border-top: 1px solid var(--border-dark);
            border-left: 1px solid var(--border-dark);
            border-right: 1px solid var(--border-light);
            border-bottom: 1px solid var(--border-light);
            background: #ffffff; 
            display: inline-block;
            margin-bottom: -1px;
            position: relative;
            z-index: 10;
        }

        .section-content {
            padding: 15px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: var(--window-bg);
            margin-top: -1px;
        }

        /* --- Main Grid Layout --- */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* --- Color Groups --- */
        .color-group {
            margin-bottom: 15px;
            padding: 10px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: var(--input-bg);
        }

        .color-group-header {
            font-size: 11px;
            font-weight: normal;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .color-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-preview {
            width: 32px;
            height: 32px;
            border-style: solid;
            border-width: 2px;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            cursor: pointer;
            display: block;
        }

        .color-input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .hex-input {
            width: 80px;
            padding: 4px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            font-size: 10px;
            text-align: center;
            background: var(--input-bg);
            color: var(--text-color);
            font-family: 'Press Start 2P', monospace;
        }

        .hex-input:focus {
            box-shadow: 0 0 0 1px var(--text-color) inset;
        }

        .position-container {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .position-slider {
            flex: 1;
            height: 20px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: var(--input-bg);
            -webkit-appearance: none;
            appearance: none;
            outline: none;
        }

        .position-slider::-webkit-slider-track {
            height: 14px;
            background: var(--input-bg);
            border: none;
        }

        .position-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--header-title);
            border-style: solid;
            border-width: 2px;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            cursor: pointer;
        }

        .position-slider::-moz-range-track {
            height: 14px;
            background: var(--input-bg);
            border: none;
        }

        .position-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--header-title);
            border-style: solid;
            border-width: 2px;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            cursor: pointer;
            border-radius: 0;
        }

        .position-value {
            font-size: 9px;
            color: var(--text-color);
            min-width: 40px;
            text-align: right;
        }

        /* --- Control Inputs --- */
        .control-row {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
        }

        .control-group {
            flex: 1;
        }

        .control-label {
            font-size: 10px;
            font-weight: normal;
            margin-bottom: 6px;
            display: block;
        }

        .control-input {
            width: 100%;
            padding: 4px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            font-size: 10px;
            background: var(--input-bg);
            color: var(--text-color);
            font-family: 'Press Start 2P', cursive;
        }

        .control-input:focus {
            box-shadow: 0 0 0 1px var(--text-color) inset;
        }

        .control-input:disabled {
            background: var(--border-dark);
            color: var(--button-pressed);
        }

        /* --- Buttons --- */
        .btn {
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            background: var(--button-face);
            color: var(--text-color);
            padding: 8px 12px;
            font-size: 10px;
            text-align: center;
            cursor: pointer;
            transition: none;
            box-shadow: none;
            line-height: 1;
            font-family: 'Press Start 2P', cursive;
        }

        .btn:active {
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            padding: 9px 11px 7px 13px;
        }

        .btn:disabled {
            background: var(--border-dark);
            color: var(--button-pressed);
            cursor: not-allowed;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
        }

        .btn:disabled:active {
            padding: 8px 12px;
        }

        .btn-primary {
            background: var(--header-title);
            color: var(--border-light);
            position: relative;
        }

        .btn-remove {
            background: var(--error-color);
            color: var(--text-color);
            font-size: 8px;
            padding: 4px 8px;
        }

        .btn-remove:active {
            padding: 5px 7px 3px 9px;
        }

        .button-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* --- Gradient Preview --- */
        .gradient-preview {
            width: 100%;
            height: 300px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: linear-gradient(51deg, #3f5d85 0%, #3ea145 100%);
            margin-bottom: 15px;
        }

        /* --- CSS Output --- */
        .css-output-container {
            padding: 12px;
            border-style: solid;
            border-width: 3px;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            background: var(--input-bg);
            font-family: 'Press Start 2P', monospace;
            font-size: 9px;
            word-break: break-all;
            line-height: 1.4;
        }

        .css-output-label {
            font-size: 10px;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        /* --- Copy Message --- */
        .copy-message {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-color);
            color: var(--border-light);
            padding: 4px 8px;
            font-size: 8px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .copy-message.visible {
            opacity: 1;
        }

        /* --- Hidden Elements --- */
        .color-group-3 {
            display: none;
        }

        /* --- Responsive Design --- */
        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .control-row {
                flex-direction: column;
                gap: 8px;
            }
            
            .color-controls {
                flex-wrap: wrap;
            }
            
            .button-row {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container window-frame">
        <div class="title-bar">
            <div class="title-bar-text">Gradient Generator</div>
        </div>
        
        <div class="app-body">
            <div class="main-grid">
                <!-- CONTROL PANEL -->
                <div>
                    <div class="section">
                        <div class="section-header">Controls</div>
                        <div class="section-content" id="control-panel">
                            <div class="control-row">
                                <div class="control-group">
                                    <label for="rotation" class="control-label">Rotation (0-360Â°)</label>
                                    <input type="number" id="rotation" min="0" max="360" step="1" value="51" class="control-input">
                                </div>
                                <div class="control-group">
                                    <label for="type" class="control-label">Type</label>
                                    <select id="type" class="control-input">
                                        <option value="linear" selected>Linear</option>
                                        <option value="radial">Radial</option>
                                    </select>
                                </div>
                            </div>

                            <div id="color-groups-container">
                                <div id="color-group-1" class="color-group">
                                    <div class="color-group-header">
                                        <span>Color 1</span>
                                    </div>
                                    <div class="color-controls">
                                        <label style="cursor: pointer;">
                                            <span class="color-preview" style="background-color: #3f5d85;" data-id="1"></span>
                                            <input type="color" class="color-input" data-id="1" value="#3f5d85">
                                        </label>
                                        <input type="text" data-id="1" class="hex-input" value="#3f5d85" maxlength="7">
                                        <div class="position-container">
                                            <input type="range" data-id="1" min="0" max="100" value="0" class="position-slider">
                                            <span class="position-value" data-id="1">0%</span>
                                        </div>
                                    </div>
                                </div>

                                <div id="color-group-2" class="color-group">
                                    <div class="color-group-header">
                                        <span>Color 2</span>
                                    </div>
                                    <div class="color-controls">
                                        <label style="cursor: pointer;">
                                            <span class="color-preview" style="background-color: #3ea145;" data-id="2"></span>
                                            <input type="color" class="color-input" data-id="2" value="#3ea145">
                                        </label>
                                        <input type="text" data-id="2" class="hex-input" value="#3ea145" maxlength="7">
                                        <div class="position-container">
                                            <input type="range" data-id="2" min="0" max="100" value="100" class="position-slider">
                                            <span class="position-value" data-id="2">100%</span>
                                        </div>
                                    </div>
                                </div>

                                <div id="color-group-3" class="color-group color-group-3">
                                    <div class="color-group-header">
                                        <span>Color 3</span>
                                        <button onclick="removeColor(3)" class="btn btn-remove">Remove</button>
                                    </div>
                                    <div class="color-controls">
                                        <label style="cursor: pointer;">
                                            <span class="color-preview" style="background-color: #00FF00;" data-id="3"></span>
                                            <input type="color" class="color-input" data-id="3" value="#00FF00">
                                        </label>
                                        <input type="text" data-id="3" class="hex-input" value="#00FF00" maxlength="7">
                                        <div class="position-container">
                                            <input type="range" data-id="3" min="0" max="100" value="50" class="position-slider">
                                            <span class="position-value" data-id="3">50%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="button-row">
                                <button id="random-btn" class="btn">Random</button>
                                <button id="add-color-btn" class="btn">Add Color</button>
                                <button id="copy-css-btn" class="btn btn-primary">
                                    Copy CSS
                                    <span id="copy-message" class="copy-message">Copied!</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PREVIEW AREA -->
                <div>
                    <div class="section">
                        <div class="section-header">Preview</div>
                        <div class="section-content">
                            <div class="gradient-preview" id="gradient-preview"></div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-header">Generated CSS</div>
                        <div class="section-content">
                            <div class="css-output-container">
                                <div class="css-output-label">CSS Code:</div>
                                <code id="css-output">background: linear-gradient(51deg, #3f5d85 0%, #3ea145 100%);</code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Gradient Logic ---
        const $ = selector => document.querySelector(selector);
        const $$ = selector => document.querySelectorAll(selector);

        let gradientState = {
            type: 'linear', // 'linear' or 'radial'
            rotation: 51, // degrees
            colors: [
                { id: 1, hex: '#3f5d85', position: 0 },
                { id: 2, hex: '#3ea145', position: 100 }
            ],
            maxColors: 3
        };

        const previewEl = $('#gradient-preview');
        const cssOutputEl = $('#css-output');
        const addColorBtn = $('#add-color-btn');
        const randomBtn = $('#random-btn'); 
        const colorGroup3El = $('#color-group-3');
        const rotationSelect = $('#rotation');
        const typeSelect = $('#type');
        const copyCssBtn = $('#copy-css-btn');
        const controlPanel = $('#control-panel');

        /**
         * Generates the CSS gradient string based on current state.
         * @returns {string} The full CSS property value.
         */
        const generateGradientCSS = () => {
            // 1. Sort colors by position
            const sortedColors = [...gradientState.colors].sort((a, b) => a.position - b.position);

            // 2. Create the color stop list (e.g., "#HEX POS%, #HEX2 POS2%")
            const colorStops = sortedColors.map(color => `${color.hex} ${color.position}%`).join(', ');

            // 3. Generate the full gradient string
            if (gradientState.type === 'linear') {
                return `linear-gradient(${gradientState.rotation}deg, ${colorStops})`;
            } else {
                return `radial-gradient(circle, ${colorStops})`;
            }
        };

        /**
         * Updates the preview and CSS output.
         */
        const updateUI = () => {
            // Update gradient preview
            const gradientCSS = generateGradientCSS();
            previewEl.style.background = gradientCSS;
            cssOutputEl.textContent = `background: ${gradientCSS};`;

            // Update color inputs and previews
            gradientState.colors.forEach(color => {
                const colorPreview = $(`.color-preview[data-id="${color.id}"]`);
                const colorInput = $(`.color-input[data-id="${color.id}"]`);
                const hexInput = $(`.hex-input[data-id="${color.id}"]`);
                const positionSlider = $(`.position-slider[data-id="${color.id}"]`);
                const positionValue = $(`.position-value[data-id="${color.id}"]`);

                if (colorPreview) colorPreview.style.backgroundColor = color.hex;
                if (colorInput) colorInput.value = color.hex;
                if (hexInput) hexInput.value = color.hex;
                if (positionSlider) positionSlider.value = color.position;
                if (positionValue) positionValue.textContent = `${color.position}%`;
            });

            // Update rotation and type selects
            rotationSelect.value = gradientState.rotation.toString();
            typeSelect.value = gradientState.type;

            // Disable rotation select if radial
            rotationSelect.disabled = gradientState.type === 'radial';

            // Update Add Color Button state
            const isMaxColors = gradientState.colors.length >= gradientState.maxColors;
            addColorBtn.disabled = isMaxColors;
            if (isMaxColors) {
                addColorBtn.textContent = 'Max Colors';
            } else {
                addColorBtn.textContent = 'Add Color';
            }
        };

        /**
         * Handles all input changes to update the state and UI.
         */
        const handleInputChange = (e) => {
            const target = e.target;
            const value = target.value;

            if (target === rotationSelect) {
                gradientState.rotation = parseInt(value) || 0;
            } else if (target === typeSelect) {
                gradientState.type = value;
                rotationSelect.disabled = value === 'radial';
            } else if (target.classList.contains('color-input')) {
                const id = parseInt(target.getAttribute('data-id'));
                const color = gradientState.colors.find(c => c.id === id);
                if (color) {
                    color.hex = value;
                    $(`.hex-input[data-id="${id}"]`).value = value;
                }
            } else if (target.classList.contains('hex-input')) {
                const id = parseInt(target.getAttribute('data-id'));
                const color = gradientState.colors.find(c => c.id === id);
                if (color && /^#[0-9A-F]{6}$/i.test(value)) {
                    color.hex = value;
                    $(`.color-input[data-id="${id}"]`).value = value;
                    $(`.color-preview[data-id="${id}"]`).style.backgroundColor = value;
                }
            } else if (target.classList.contains('position-slider')) {
                const id = parseInt(target.getAttribute('data-id'));
                const color = gradientState.colors.find(c => c.id === id);
                if (color) {
                    color.position = parseInt(value);
                    $(`.position-value[data-id="${id}"]`).textContent = `${value}%`;
                }
            }

            updateUI();
        };

        /**
         * Handles color preview clicks to trigger color picker.
         */
        const handleColorPreviewClick = (e) => {
            const colorPreview = e.target;
            if (colorPreview.classList.contains('color-preview')) {
                const id = colorPreview.getAttribute('data-id');
                const colorInput = $(`.color-input[data-id="${id}"]`);
                if (colorInput) {
                    colorInput.click();
                }
            }
        };

        /**
         * Adds a new color to the gradient.
         */
        const addColor = () => {
            if (gradientState.colors.length >= gradientState.maxColors) return;

            const newId = Math.max(...gradientState.colors.map(c => c.id)) + 1;
            const newColor = {
                id: newId,
                hex: generateRandomColor(),
                position: 50
            };

            gradientState.colors.push(newColor);

            // Show the third color group if adding the third color
            if (gradientState.colors.length === 3) {
                colorGroup3El.style.display = 'block';
            }

            updateUI();
        };

        /**
         * Removes a color from the gradient.
         */
        window.removeColor = (id) => {
            gradientState.colors = gradientState.colors.filter(c => c.id !== id);

            // Hide the third color group if removing the third color
            if (id === 3) {
                colorGroup3El.style.display = 'none';
            }

            updateUI();
        };

        /**
         * Generates a random hex color.
         */
        const generateRandomColor = () => {
            return '#' + Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
        };

        /**
         * Randomizes the gradient.
         */
        const randomizeGradient = () => {
            // Randomize existing colors and positions
            gradientState.colors = gradientState.colors.map(color => {
                const id = color.id;
                let newPosition;

                if (gradientState.colors.length === 1) {
                    newPosition = 0;
                } else if (gradientState.colors.length === 2) {
                    newPosition = id === 1 ? 0 : 100;
                } else if (gradientState.colors.length === 3) {
                    if (id === 1) {
                        newPosition = 0;
                    } else if (id === 2) {
                        newPosition = 100;
                    } else if (id === 3) {
                        newPosition = Math.floor(Math.random() * 98) + 1;
                    }
                }

                return {
                    ...color,
                    hex: generateRandomColor(),
                    position: newPosition
                };
            });

            // Randomize type and rotation
            const isLinear = Math.random() < 0.7;
            gradientState.type = isLinear ? 'linear' : 'radial';
            
            if (isLinear) {
                gradientState.rotation = Math.floor(Math.random() * 361);
            }
            
            rotationSelect.value = gradientState.rotation.toString();
            typeSelect.value = gradientState.type;

            updateUI();
        };

        /**
         * Copies the CSS to clipboard.
         */
        const copyCSSToClipboard = () => {
            const css = `background: ${generateGradientCSS()};`;
            const textarea = document.createElement('textarea');
            textarea.value = css;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                const copyMessage = $('#copy-message');
                copyMessage.classList.add('visible');
                setTimeout(() => copyMessage.classList.remove('visible'), 2000);
            } catch (err) {
                console.error('Could not copy text: ', err);
            } finally {
                document.body.removeChild(textarea);
            }
        };

        // --- Event Listeners Setup ---
        window.onload = () => {
            // Initial UI update
            updateUI();

            // Attach listeners
            if (controlPanel) {
                controlPanel.addEventListener('input', handleInputChange);
                controlPanel.addEventListener('change', handleInputChange);
                controlPanel.addEventListener('click', handleColorPreviewClick);
            }

            addColorBtn.addEventListener('click', addColor);
            randomBtn.addEventListener('click', randomizeGradient);
            copyCssBtn.addEventListener('click', copyCSSToClipboard);
        };
    </script>
</body>
</html>